# ุฌุณุฑ ุงูุฑุจุท ุจูู ุจูุงุจุฉ ุฏูุน ููุณุฑ ูููุตุฉ Ecwid

ูุดุฑูุน ูุชูุงูู ูุฌุงูุฒ ููุฅูุชุงุฌ ููุฑุจุท ุจูู **ุจูุงุจุฉ ุฏูุน ููุณุฑ (Moyasar)** ูููุตุฉ ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ **Ecwid**. ุชู ุจูุงุคู ุจุงุณุชุฎุฏุงู **Node.js/Express** ููู ูุญุณู ููุนูู ุนูู **Vercel Serverless Functions**.

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงููุดุฑูุน ูุนูู ูุทุจูุฉ ูุณูุทุฉ (Middleware) ุชุนุงูุฌ ุชุฏูู ุนูููุฉ ุงูุฏูุนุ ูุชุฑุจุท ุทูุจุงุช Ecwid ุจุจูุงุจุฉ ููุณุฑุ ูุชุญุฏุซ ุญุงูุฉ ุงูุทูุจุงุช ุชููุงุฆูุงู ูู Ecwid ุจุนุฏ ุฅุชูุงู ุงูุฏูุน.

### ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ
- **ุชุฏูู ุฏูุน ุณูุณ**: ุตูุญุฉ ุฏูุน ูุฎุตุตุฉ ุชุฑุจุท ุทูุจุงุช Ecwid ุจู Moyasar ุจุดูู ูุจุงุดุฑ.
- **ุชุญุฏูุซ ุชููุงุฆู ููุญุงูุฉ**: ูุฒุงููุฉ ููุฑูุฉ ูุญุงูุฉ ุงูุทูุจ ูู Ecwid ุนุจุฑ ุงูู Webhooks.
- **ุฏุนู ูุณุงุฆู ุฏูุน ูุชุนุฏุฏุฉ**: ุจุทุงูุงุช ุงูุงุฆุชูุงูุ Apple Payุ ู STC Pay.
- **ูุธุงู ูุชุทูุฑ ููุนุงูุฌุฉ ุงูุฃุฎุทุงุก**: ุงุณุชุฌุงุจุงุช API ููุญุฏุฉ ููุธุงู ุชุณุฌูู logs ุฏููู.
- **ุฌุงูุฒ ูููุดุฑ ุนูู Vercel**: ุฅุนุฏุงุฏุงุช ูุณุจูุฉ ูููุดุฑ ุงูุณุฑูุน ูุงููุฌุงูู.
- **ุญูุงูุฉ ูุฃูุงู**: ุงูุชุญูู ูู ุชูููุน ุงูู Webhooks ูุญูุงูุฉ ุงูู API ุจููุงุชูุญ ุณุฑูุฉ.

---

## ๐ ูุชุทูุจุงุช ุงูุชุดุบูู
- **Node.js**: ุงูุฅุตุฏุงุฑ 18 ุฃู ุฃุญุฏุซ.
- **npm**: ุงูุฅุตุฏุงุฑ 9 ุฃู ุฃุญุฏุซ.
- **ุญุณุงุจ Vercel**: ูููุดุฑ (ุงุฎุชูุงุฑู ูููู ูุณุชุญุณู).
- **ุญุณุงุจ ููุณุฑ**: ููุญุตูู ุนูู ููุงุชูุญ ุงูู API (Test/Live).
- **ูุชุฌุฑ Ecwid**: ูููุตูู ุฅูู ุงูู API ูุฅุนุฏุงุฏ ุงูู Webhooks.

---

## ๐ ุชุนูููุงุช ุงูุฅุนุฏุงุฏ

### 1. ุชุญููู ุงููุดุฑูุน
```bash
git clone https://github.com/your-username/moyasar-ecwid-integration.git
cd moyasar-ecwid-integration
```

### 2. ุชุซุจูุช ุงูุญุฒู
```bash
npm install
```

### 3. ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
ูู ุจูุณุฎ ููู `.env.example` ุฅูู `.env` ููู ุจุชุนุจุฆุฉ ุงูุจูุงูุงุช:
```bash
cp .env.example .env
```

### 4. ุงูุชุดุบูู ุงููุญูู
```bash
npm run dev
```
ุณูุนูู ุงูุณูุฑูุฑ ุนูู ุงูุฑุงุจุท: `http://localhost:3000`.

---

## โ๏ธ ูุชุบูุฑุงุช ุงูุจูุฆุฉ (Environment Variables)

| ุงููุชุบูุฑ | ุงููุตู | ููุงู ุงูุญุตูู ุนููู |
|----------|-------------|-----------------|
| `MOYASAR_API_KEY_TEST` | ุงูููุชุงุญ ุงูุณุฑู ููุงุฎุชุจุงุฑ | ููุญุฉ ุชุญูู ููุณุฑ > ุงูุฅุนุฏุงุฏุงุช > API Keys |
| `MOYASAR_API_KEY_LIVE` | ุงูููุชุงุญ ุงูุณุฑู ููุฅูุชุงุฌ | ููุญุฉ ุชุญูู ููุณุฑ > ุงูุฅุนุฏุงุฏุงุช > API Keys |
| `ECWID_STORE_ID` | ูุนุฑู ูุชุฌุฑ Ecwid ุงูุฎุงุต ุจู | ููุญุฉ ุชุญูู Ecwid (ุฃุณูู ุงููุณุงุฑ) |
| `ECWID_TOKEN` | ููุชุงุญ ุงููุตูู ุงูุณุฑู (Secret Token) | ููุญุฉ ุชุญูู Ecwid > Apps > My Apps |
| `APP_API_KEY` | ููุชุงุญ ุญูุงูุฉ ุชุทุจููู ุงูุฎุงุต | ูู ุจุฅูุดุงุฆู ูุฏููุงู (ูุต ุนุดูุงุฆู) |

---

## ๐ ุฎุทูุงุช ุงูุฑุจุท ุงููุนูู

### 1. ุฅุนุฏุงุฏ Ecwid
ูุชูุฌูู ุงูุนููุงุก ูุฌุณุฑ ุงูุฏูุนุ ุงุฐูุจ ุฅูู **Ecwid Control Panel > Design**:
1. ูู ุจุฅุถุงูุฉ ููุฏ JavaScript ูู ุตูุญุฉ "ุดูุฑุงู ูู" (Thank You Page) ูุฅุนุงุฏุฉ ุงูุชูุฌูู:
   ```javascript
   if (Ecwid.getCart().paymentStatus === 'AWAITING_PAYMENT') {
     const orderId = Ecwid.getCart().orderId;
     window.location.href = `https://your-app.vercel.app/checkout/${orderId}`;
   }
   ```

### 2. ุฅุนุฏุงุฏ Webhooks ูู ููุณุฑ
1. ุงุฐูุจ ุฅูู **Moyasar Dashboard > Settings > Webhooks**.
2. ุฃุถู URL ุฌุฏูุฏ: `https://your-app.vercel.app/api/webhooks/moyasar`.
3. ุงุฎุชุฑ ุงูุฃุญุฏุงุซ: `payment.paid` ู `payment.failed`.

---

## ๐ ุชูุซูู ุงูู API

### ุงูุฑุงุจุท ุงูุฃุณุงุณู
`https://your-app.vercel.app/api`

### ุงูููุงุท ุงูููุชุงุญูุฉ (Endpoints)
- **GET /health**: ูุญุต ุญุงูุฉ ุงููุธุงู.
- **POST /orders/:id/pay**: ุจุฏุก ุนูููุฉ ุฏูุน ูุทูุจ ูุนูู ูู Ecwid.
- **POST /webhooks/moyasar**: ุงุณุชูุจุงู ุฅุดุนุงุฑุงุช ุงูุฏูุน ูู ููุณุฑ.
- **GET /checkout/:orderId**: ุตูุญุฉ ุงูุชูุฌูู ุงูุชู ูุฑุงูุง ุงูุนููู ูุจู ุงูุงูุชูุงู ูููุณุฑ.

---

## ๐ ุงูุชุฑุฎูุต
ูุฐุง ุงููุดุฑูุน ูุฑุฎุต ุชุญุช ุฑุฎุตุฉ **MIT**.
